@startuml
title neochibu - Component Architecture (MVP + Extensions)

skinparam componentStyle rectangle
skinparam shadowing false
skinparam wrapWidth 220

package "Frontend (Next.js)" {
  [Room UI\n(検索/入室/評価)] as C_RoomUI
  [Wallet Connector\n(Ethers.js)] as C_Wallet
  [AI Helper\n(LLM/翻訳/要約)] as C_AIHelper
  [Adult Entry UI\n(18+ ゲート)] as C_AdultUI
}

package "Backend API (Node.js)" {
  [Auth Service\n(匿名/ウォレット紐付け)] as S_Auth
  [Room Service\n(作成/設定/発見性/上位表示)] as S_Room
  [Payment Service\n(入室/時間課金/検証)] as S_Pay
  [Rating Service\n(星/コメント)] as S_Rating
  [Shop Service\n(商品/注文/在庫)] as S_Shop
  [Log/Privacy Service\n(暗号化/鍵管理)] as S_Priv
  [Adult Gate Service\n(年齢検証/別経路制御)] as S_Adult
  [DAO Service\n(分配/投票/提案)] as S_DAO
}

package "Infra" {
  [WebRTC SFU/Signaling] as INF_RTC
  [IPFS Gateway] as INF_IPFS
  [DB (PostgreSQL/MySQL)] as INF_DB
  [Cache (Redis)] as INF_CACHE
  [Object Storage] as INF_OBJ
}

cloud "Ethereum / L2" as CHAIN
cloud "ZK Proof/Verifier\n(年齢/利用証明 将来拡張)" as ZK

C_RoomUI --> S_Room
C_Wallet --> S_Pay
C_AIHelper --> C_RoomUI
C_AdultUI --> S_Adult

S_Room --> INF_DB
S_Rating --> INF_DB
S_Pay --> INF_DB
S_Pay --> CHAIN : Tx検証/イベント購読
S_Priv --> INF_IPFS : 暗号化ログ
S_Priv --> INF_OBJ : 暗号化スナップショット
S_Adult --> ZK : 18+ 証明検証(将来)
S_DAO --> CHAIN : 分配/投票
S_Room --> INF_RTC
C_RoomUI --> INF_RTC : Media/Signaling

@enduml
